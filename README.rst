Go read the cloud-planning.lhs file. It's literate Haskell, and it explains itself.
